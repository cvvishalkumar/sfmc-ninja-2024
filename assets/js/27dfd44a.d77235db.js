"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[936],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>S});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),u=a,S=d["".concat(l,".").concat(u)]||d[u]||m[u]||o;return n?r.createElement(S,i(i({ref:t},p),{},{components:n})):r.createElement(S,i({ref:t},p))}));function S(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5397:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_label:"SSJS snippets",sidebar_position:1},i="SSJS snippets",s={unversionedId:"SSJS/SSJS-snippets",id:"SSJS/SSJS-snippets",title:"SSJS snippets",description:"",source:"@site/docs/02_SSJS/SSJS-snippets.md",sourceDirName:"02_SSJS",slug:"/SSJS/SSJS-snippets",permalink:"/sfmc-ninja-2024/docs/SSJS/SSJS-snippets",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02_SSJS/SSJS-snippets.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_label:"SSJS snippets",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"SSJS",permalink:"/sfmc-ninja-2024/docs/category/ssjs"},next:{title:"SQL",permalink:"/sfmc-ninja-2024/docs/category/sql"}},l={},c=[],p={toc:c},d="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"ssjs-snippets"},"SSJS snippets"),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"Contact Deletion using SSJS ","[Delete all contacts in a DE using API]"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},"<script runat=\"server\">\n Platform.Load(\"core \",\"1.1.5 \");\n  \n  try{\n  /* var eid = Platform.Function.AuthenticatedEnterpriseID(); use this if running from parent BU else hardcode as below*/\n  var eid = '51000xxxx';\n  var deKey = '_Your_DEkey_from_which_Contacts_to_be_Deleted_';\n  var clientId = 'xxxxxxxxxxxxxxxxxxxxxx';\n  var clientSecret = 'xxxxxxxxxxxxxxxxxx';\n  var authBaseUrl = 'https://xxxxxxxxxxxxxxxxx.auth.marketingcloudapis.com/';\n  \n  var authUrl = authBaseUrl + 'v2/token/'\n  var contentType = 'application/json';\n  \n  payload =  '{';\n  payload += ' \"grant_type \": \"client_credentials \",';\n  payload += ' \"client_id \":\" ' + clientId + ' \",';\n  payload += ' \"client_secret \":\" ' + clientSecret + ' \",';\n  payload += ' \"scope \": \"list_and_subscribers_write \",';\n  payload += ' \"account_id \": \" ' + eid + ' \" ';\n  payload += '}';\n  \n  var result = HTTP.Post(authUrl, contentType, payload);\n  var response = result[\"Response \"][0];\n  var accessToken = Platform.Function.ParseJSON(response).access_token;\n  var restUrl = Platform.Function.ParseJSON(response).rest_instance_url;\n  \n  Platform.Response.Write(\" response: \" + response);\n  Platform.Response.Write(\"\\n\\n token: \" + accessToken);\n  Platform.Response.Write(\"\\n\\n rest URL: \" + restUrl);\n  \n  var headerNames = [\"Authorization \"];\n  var headerValues = [\"Bearer \" + accessToken];\n  \n  payload =  '{';\n  payload += '   \"deleteOperationType \": \"ContactAndAttributes \",';\n  payload += '   \"targetList \": { ';\n  payload += '      \"listType \": { ';\n  payload += '         \"listTypeID \":3';\n  payload += '      },';\n  payload += '   \"listKey \": \" ' + deKey + ' \"';\n  payload += '   },';\n  payload += '   \"deleteListWhenCompleted \":false,';\n  payload += '   \"deleteListContentsWhenCompleted \":true';\n  payload += '}';\n  \n  var deleteEndpoint = restUrl + 'contacts/v1/contacts/actions/delete?type=listReference';\n  var result = HTTP.Post(deleteEndpoint, contentType, payload, headerNames, headerValues)\n  result = Stringify(result).replace(/[\\n\\r]/g, '');\n  Platform.Response.Write(\"\\n\\n result: \" + result);\n  }\n  catch(e) {  Write(Stringify(e)); }\n<\/script>\n"))),(0,a.kt)("admonition",{title:"JSON parsing using SSJS",type:"info"},(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},'Example: JSON\n[\n  {\n    "Prod_ID ": 1,\n    "Prod_Name ": "Nike",\n    "Prod_Desc ": "Shoe"\n  },\n  {\n    "Prod_ID ": 5,\n    "Prod_Name ": "Puma",\n    "Prod_Desc ": "Slipper"\n  },\n  {\n    "Prod_ID ": 10,\n    "Prod_Name ": "Adidas",\n    "Prod_Desc ": "Jacket"\n  }\n]\n\n<script runat="server">\n    Platform.Load("Core","1.1.1");\n    var json = Platform.Request.GetPostData();\n    var products = Platform.Function.ParseJSON(json);\n    \n    if (products.length > 0) {\n        for (var i = 0; i < products.length; i++ ) {\n            var item = products[i];\n            Platform.Variable.SetValue("@Prod_ID",item[\'Prod_ID\']);\n            Platform.Variable.SetValue("@Prod_Name",item[\'Prod_Name\']);\n            Platform.Variable.SetValue("@Prod_Desc",item[\'Prod_Desc\']);\n    <\/script>\n            <br>Prod_ID = %%=v(@Prod_ID)=%%  || Prod_Name = %%=v(@Prod_Name)=%% || Prod_Desc = %%=v(@Prod_Desc)=%%\n    <script runat="server">\n        }\n    } \n    else \n    {\n        Write("no products found");\n    }\n<\/script>\n'))),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"Run automation in Child BU from Parent BU ","[via Script activity]"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},'<script runat="server">\nPlatform.Load(\'core\', \'1\');\n   MyFunc = {\n    Init: function(ObjectID,MID) {\n    var obj = {};\n    \n    obj.Perform = function() {\n    try {\n        var program = Platform.Function.CreateObject("Program ");\n        var clientID = Platform.Function.CreateObject("ClientID ");\n        Platform.Function.SetObjectProperty(clientID, "ID ", MID);\n        Platform.Function.SetObjectProperty(clientID, "IDSpecified ", "true ");\n        Platform.Function.SetObjectProperty(program, "Client ", clientID);\n        Platform.Function.SetObjectProperty(program, "ObjectID ", ObjectID);\n        Platform.Function.InvokePerform(program, "Start ", status);\n        return status[0];\n        }  \n      \n    catch (err) { return err.message; }\n    };\n    return obj;\n    }\n   };\n\n   var myClientID = [MID]; // Your Business UNIT MID\n   var myAutomation = "[automationExternalKey] "; // NOT the name! use ExternalKey\n   var childAutomation = MyFunc.Init(myAutomation,myClientID);\n   childAutomation.Perform();\n<\/script>\n'))),(0,a.kt)("admonition",{title:"SSJS to make an HTTP POST request",type:"info"},(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},'<script runat=server>\nPlatform.Load("core", "1.1.1");\n\n/* Parameters sent in POST */\nvar First_Name = Request.GetQueryStringParameter("First_Name");\nvar Last_Name = Request.GetQueryStringParameter("Last_Name");\nvar Email_Address = Request.GetQueryStringParameter("Email_Address");\n\n/* Comment below once you complete debugging */\nWrite(\'First_Name = \'+  First_Name);\nWrite(\'Last_Name = \'+  Last_Name);\nWrite(\'Email_Address = \'+  Email_Address);\n\nvar url = \'https://enhymz81cmxk5.x.pipedream.net\';\n\n/* Make sure NO spaces in below JSON */\nvar payload = \'{"First_Name":"\'+First_Name+\'","Last_Name":"\'+Last_Name+\'","Email_Address":"\'+Email_Address+\'"}\';\n\nvar req = new Script.Util.HttpRequest(url);\nreq.emptyContentHandling = 0;\nreq.retries = 2;\nreq.continueOnError = true;\nreq.contentType = "application/json"\nreq.setHeader("API-TOKEN", "xxxxx");\nreq.method = "POST"; \nreq.postData = payload;\n\nvar resp = req.send();\n<\/script>\n'))),(0,a.kt)("admonition",{title:"Get n SET variables in JS vs SSJS variables",type:"info"},(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},'\n  <html>\n    <head>\n    <title>SFMC Ninja</title>\n            <script runat="client">\n                var JS_variable = "Welcome to ";    //Setting Javascript Variable\n                console.log(JS_variable);           //Output to console from Javascript\n            <\/script>\n    </head>\n    <body>\n            <h1 id=\'header\'></h1>                   \x3c!-- Placeholder for HTML output --\x3e\n    \n            <script runat=\'server\' language=\'javascript\'>\n            Platform.Load(\'Core\',\'1.1\'); \n            var SSJS_variable = "SFMC ";            //Setting SSJS Variable\n            <\/script>\n     \n            %%[SET @AMPscript_variable = "Ninja"]%%  \x3c!-- Setting AMPscript Variable --\x3e\n    \n            <script runat=server>\n                var message = SSJS_variable + Variable.GetValue("@AMPscript_variable"); //Concat SSJS + AMPscript variables\n                Write(\'<script>console.log("\' + message + \'")<\/script>\');   //Output to console from SSJS\n            <\/script>\n    \n    <script runat="client">\n    document.getElementById("header").innerHTML = JS_variable + "SFMC " + "%%=v(@AMPscript_variable)=%%"; //HTML output using JS + AMPscript \n    <\/script>\n    \n    </body>\n    </html>\n'))))}m.isMDXComponent=!0}}]);